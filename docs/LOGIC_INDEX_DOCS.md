# Student Hub — Frontend & Backend Documentation

This document describes the main client and server logic for the Student Hub project:
- Frontend: `FrontEnd/logic.js`
- Backend: `BackEnd/src/index.js`

Use this as a quick reference for behavior, endpoints, and integration points.

**Frontend: `FrontEnd/logic.js`**

- Purpose: dynamic UI behaviors for the courses page and profile page. Handles loading courses, displaying a table, voting buttons, search, and simple profile rendering.

Key exported/global items and functions:

- `window.recordVote(id, delta = 1)`
  - Sends a POST to `/vote` with JSON `{ id, delta }`.
  - Returns `{ success: true, data }` on success where `data` contains `{ id, votes }`.
  - Example usage: `recordVote('CPSC-101', 1).then(res => ...)`.

- `fetchCourses()`
  - Fetches `/courses` and populates the local `courses` array.
  - Expects backend to return an array of course objects `{ id, name, status, ... }`.
  - Logs errors and returns an empty array if fetch fails.

- `fetchVotes()`
  - Fetches `/votes` and populates `VOTES` object mapping `id -> count`.
  - Used to show current vote counts next to each course.

- `loadTable()`
  - Renders an HTML table into the element `#tableX`.
  - For each course in `courses` (skips entries without `name` or `id`) it renders a row:
    - Course Name (cell with class `.courses`)
    - Status (cell with class `.status`)
    - Votes: an upvote button `<button class="vote-btn" data-id="ID">▲</button>` and a `<span id="vote-count-ID">N</span>` showing count.
  - Adds click handlers to `.vote-btn` buttons which call `recordVote(id, 1)`, update `VOTES`, and call `updateVoteDisplay(id, count)`.
  - If no courses are returned, displays a fallback row: `No courses available.`
  - Logs a warning if any course entries are skipped because they lack `id`.

- `updateVoteDisplay(id, count)`
  - Updates the DOM element `#vote-count-ID` with the provided count.

- Search UI
  - The search input `#searchInput` and `#searchBtn` work with `searchFunction()` which filters rows by course name (uses `.courses` cells).

- Profile loader
  - `profileLoader()` renders simple profile fields into `#profile-section` when present.

Important implementation notes
- The frontend expects each course object from the backend to include a stable `id` field. This `id` is used for DOM ids and vote keys.
- Fetch endpoints are relative (`/courses`, `/votes`, `/vote`) and assume the frontend is served from the same origin as the backend.
- If you want file:// testing, you can either allow CORS on the backend or serve the frontend from the backend (recommended).


**Backend: `BackEnd/src/index.js`**

- Purpose: simple Express server that serves courses and stores votes in JSON files.

Key files
- `database.json` — array of course objects. Each course should include `{ id, name, status, category, ... }`.
- `votes.json` — object mapping course `id` to numeric vote counts, e.g. `{ "CPSC-101": 2 }`.

Key endpoints

- `GET /courses`
  - Returns the contents of `BackEnd/src/database.json` (array of course objects).
  - If the file is missing or invalid, returns `[]` or a 500 with an error message.

- `GET /votes`
  - Returns the contents of `BackEnd/src/votes.json` (object mapping id -> count).
  - If file missing, returns `{}`.

- `POST /vote`
  - Accepts JSON body `{ id: string, delta: number }`.
  - Validates `id` and that `delta` is a number. Returns 400 on invalid input.
  - Reads `votes.json`, updates `votes[id] = (votes[id] || 0) + delta`, writes the file, and returns `{ id, votes: updatedCount }`.

- Static-serving
  - Server is configured to serve the `FrontEnd` folder as static files so the UI can be opened at `http://localhost:3000/index.html`.

Other server behaviors
- Simple CORS headers are set to allow development testing (if the frontend is opened from another origin).
- The server logs file paths for the DB and votes files on startup.

Developer notes & common tasks

- Start server:

```bash
cd BackEnd
npm install
npm start
```

- View courses via curl:

```bash
curl -s http://localhost:3000/courses | jq
```

- View votes via curl:

```bash
curl -s http://localhost:3000/votes | jq
```

- If your frontend shows `No courses available.`:
  - Confirm server is running and `GET /courses` returns the JSON array (see curl above).
  - Open browser DevTools Console for logs from `fetchCourses()`.


Frontend integration examples

- Example course row HTML (generated by `loadTable()`):

```html
<tr>
  <td class="courses">Introduction to Programming</td>
  <td class="status">Available</td>
  <td class="votes-cell">
    <button class="vote-btn" data-id="CPSC-101">▲</button>
    <span id="vote-count-CPSC-101">0</span>
  </td>
</tr>
```

- Example inline button usage (if needed):

```html
<button onclick="recordVote('CPSC-101', 1)">Upvote</button>
```

Troubleshooting tips
- If votes do not show, ensure keys in `votes.json` match the `id` values in `database.json`.
- If courses are empty, confirm `database.json` is valid JSON and contains an array of course objects with `id` and `name`.
- When changing `database.json`, restart the backend or re-request `/courses` from the frontend.


---
Generated by the project assistant to document `FrontEnd/logic.js` and `BackEnd/src/index.js` behavior.
